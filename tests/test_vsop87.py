"""
This module contains the tests for timeconv function
"""
# Standard library imports


# Third party imports
from pytest import approx
#https://www.scivision.dev/pytest-approx-equal-assert-allclose/
import numpy as np


# Local application imports
from myorbit.planets.vsop87 import *
from myorbit.planets.pluto import *
from myorbit.coord import mk_co_equat2, Coord, EQUAT2_TYPE
from myorbit.data_catalog import CometElms
from myorbit.util.timeut import datetime2jd
from myorbit.two_body import _g_rlb_equat_body_j2000
from myorbit.util import timeut as tc


def equals_cood (c1,c2,abs=None,rel=None):
    assert c1.v == approx(c2.v,abs=abs,rel=rel)
    assert c1.equinox == c2.equinox
    assert c1.type == c2.type

def test_hrlb_eclip_eqxdate():
    # pag 219 Meedus
    jde = 2448976.5
    rlb = h_rlb_eclip_eqxdate("Venus", jde, tofk5=False)
    assert rlb == approx(np.array([0.72460168, 0.45577737,-0.04573815]), abs=1e-8)


def test_grlb_equat_body_j2000_1():
    # pag 233 Meedus
    ENCKE = CometElms(name="2P/Encke",
            epoch_name=None ,
            q =  2.2091404*(1-0.8502196) ,
            e = 0.8502196 ,
            i_dg = 11.94524 ,
            Node_dg = 334.75006 ,
            w_dg = 186.23352 ,
            tp_str = "19901028.54502",
            equinox_name = "J2000")

    jde = datetime2jd(1990,10,6,0,0,0)
    c = Coord(_g_rlb_equat_body_j2000(jde,ENCKE),"", EQUAT2_TYPE)
    equals_cood(c, mk_co_equat2("10h34m14.152s","19°09m31s","",r=0.8242810837210319),abs=1e-4)


def test_grlb_equat_body_j2000_2():
    HALLEY = CometElms(name="1P/Halley",
                epoch_name=None ,
                q =  0.5870992 ,
                e = 0.9672725 ,
                i_dg = 162.23932 ,
                Node_dg = 58.14397 ,
                w_dg = 111.84658 ,
                tp_str = "19860209.43867",
                equinox_name = "B1950")

    jde = tc.datetime2jd(1985,11,15,0,0,0)
    c = Coord(_g_rlb_equat_body_j2000(jde,HALLEY),"", EQUAT2_TYPE)
    equals_cood(c, mk_co_equat2("4h00m40.226s","22°04m27s","",r=0.7368872829651026),abs=1e-5)

def test_g_xyz_equat_sun_eqxdate():    
    #pag 172 Meeus
    jde = 2448908.5
    c1 = g_xyz_equat_sun_eqxdate(jde,tofk5=True)  
    assert c1 == approx(np.array([-0.93799634, -0.3116537 , -0.13512068]), abs=1e-8)

def test_g_xyz_sun ():
    # pag 175 Meeus
    jde = 2448908.5
    c1 = g_xyz_vsopeclip_sun_j2000(jde)
    assert c1 == approx(np.array([-0.93739691, -0.3413352, -0.00000336]), abs=1e-6)
    c1 = g_xyz_equat_sun_j2000(jde)
    assert c1 == approx(np.array([-0.93739707,-0.31316724, -0.13577841]), abs=1e-6)
    

# The following tests have been generated automatially from http://neoprogrammics.com/vsop87/VSOP87_test_values.html
    
def test_series_A():
    assert h_xyz_eclip_j2000("MERCURY",2451545.0)== approx(np.array([-0.1300934115,-0.4472876716,-0.0245983802]))
    assert h_xyz_eclip_j2000("MERCURY",2415020.0)== approx(np.array([-0.3897246931,-0.1502242199,0.0236199373]))
    assert h_xyz_eclip_j2000("MERCURY",2341970.0)== approx(np.array([0.325672036,0.0880865802,-0.0229819912]))
    assert h_xyz_eclip_j2000("MERCURY",2305445.0)== approx(np.array([0.2314047967,-0.3620120986,-0.050858821]))
    assert h_xyz_eclip_j2000("MERCURY",2268920.0)== approx(np.array([-0.1495554398,-0.4409710104,-0.0218126659]))
    assert h_xyz_eclip_j2000("MERCURY",2232395.0)== approx(np.array([-0.3938651887,-0.1288399755,0.0263344445]))
    assert h_xyz_eclip_j2000("MERCURY",2195870.0)== approx(np.array([-0.14542411,0.2837569447,0.036525887]))
    assert h_xyz_eclip_j2000("MERCURY",2159345.0)== approx(np.array([0.3340760581,0.0655125084,-0.0260662236]))
    assert h_xyz_eclip_j2000("MERCURY",2122820.0)== approx(np.array([0.2146329139,-0.375229625,-0.0503982597]))
    assert h_xyz_eclip_j2000("VENUS",2451545.0)== approx(np.array([-0.7183022797,-0.0326546017,0.0410142975]))
    assert h_xyz_eclip_j2000("VENUS",2415020.0)== approx(np.array([0.6971428331,-0.2033631151,-0.0430201136]))
    assert h_xyz_eclip_j2000("VENUS",2378495.0)== approx(np.array([-0.5983535208,0.3958502156,0.0398238141]))
    assert h_xyz_eclip_j2000("VENUS",2341970.0)== approx(np.array([0.4531193265,-0.5692420969,-0.0335643217]))
    assert h_xyz_eclip_j2000("VENUS",2305445.0)== approx(np.array([-0.2501974249,0.6732855399,0.0229714783]))
    assert h_xyz_eclip_j2000("VENUS",2268920.0)== approx(np.array([0.0428334458,-0.725984493,-0.0114025161]))
    assert h_xyz_eclip_j2000("VENUS",2232395.0)== approx(np.array([0.1935421816,0.6940567996,-0.0029302736]))
    assert h_xyz_eclip_j2000("VENUS",2195870.0)== approx(np.array([-0.3830059585,-0.615087557,0.0150920021]))
    assert h_xyz_eclip_j2000("VENUS",2159345.0)== approx(np.array([0.5643550617,0.4519394442,-0.0277243709]))
    assert h_xyz_eclip_j2000("VENUS",2122820.0)== approx(np.array([-0.6660158465,-0.2753592311,0.0357874175]))
    assert h_xyz_eclip_j2000("EARTH",2451545.0)== approx(np.array([-0.1771354586,0.9672416237,-3.9e-06]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2415020.0)== approx(np.array([-0.1883079649,0.9650688844,0.0002150325]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2378495.0)== approx(np.array([-0.1993918002,0.9627974368,0.0004307602]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2341970.0)== approx(np.array([-0.2104654652,0.9603579954,0.0006472929]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2305445.0)== approx(np.array([-0.2214982928,0.9578483181,0.000856825]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2268920.0)== approx(np.array([-0.2324780153,0.9551975793,0.0010692878]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2232395.0)== approx(np.array([-0.2435134343,0.9524373311,0.001287102]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2195870.0)== approx(np.array([-0.2544603371,0.9495904257,0.0014962103]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2159345.0)== approx(np.array([-0.2654547156,0.9465233602,0.0017037737]),abs=1.e-06)
    assert h_xyz_eclip_j2000("EARTH",2122820.0)== approx(np.array([-0.2763146784,0.9433985307,0.0019115387]),abs=1.e-06)
    assert h_xyz_eclip_j2000("MARS",2451545.0)== approx(np.array([1.3907159264,-0.0134157043,-0.0344677967]),abs=1.e-06)
    assert h_xyz_eclip_j2000("MARS",2415020.0)== approx(np.array([0.4284332474,-1.355235425,-0.0389650205]))
    assert h_xyz_eclip_j2000("MARS",2378495.0)== approx(np.array([-1.1119219621,-1.0963263014,0.0049208507]))
    assert h_xyz_eclip_j2000("MARS",2341970.0)== approx(np.array([-1.6387489524,0.2507105242,0.0465605913]))
    assert h_xyz_eclip_j2000("MARS",2305445.0)== approx(np.array([-0.8307668241,1.4098595097,0.0504536061]))
    assert h_xyz_eclip_j2000("MARS",2268920.0)== approx(np.array([0.649525885,1.3657302245,0.0116922368]))
    assert h_xyz_eclip_j2000("MARS",2232395.0)== approx(np.array([1.3910394546,-0.0543839267,-0.0371012758]))
    assert h_xyz_eclip_j2000("MARS",2195870.0)== approx(np.array([0.3890073909,-1.3660431023,-0.0383808949]))
    assert h_xyz_eclip_j2000("MARS",2159345.0)== approx(np.array([-1.1440917096,-1.0595533316,0.0082180884]))
    assert h_xyz_eclip_j2000("MARS",2122820.0)== approx(np.array([-1.6278485157,0.3060194814,0.049421574]))
    assert h_xyz_eclip_j2000("JUPITER",2451545.0)== approx(np.array([4.0011740268,2.9385810077,-0.1017837501]))
    assert h_xyz_eclip_j2000("JUPITER",2415020.0)== approx(np.array([-3.019122435,-4.4582563705,0.08586419]))
    assert h_xyz_eclip_j2000("JUPITER",2378495.0)== approx(np.array([-0.0180390004,5.1317748839,-0.020044849]))
    assert h_xyz_eclip_j2000("JUPITER",2341970.0)== approx(np.array([1.2817318353,-5.0280079874,-0.009125159]))
    assert h_xyz_eclip_j2000("JUPITER",2305445.0)== approx(np.array([-4.0547959775,3.4799857072,0.0779960099]))
    assert h_xyz_eclip_j2000("JUPITER",2268920.0)== approx(np.array([4.5891471727,-1.9870837931,-0.0961092251]))
    assert h_xyz_eclip_j2000("JUPITER",2232395.0)== approx(np.array([-5.4239396005,-0.5085487291,0.1247760378]))
    assert h_xyz_eclip_j2000("JUPITER",2195870.0)== approx(np.array([4.242328634,2.5898433579,-0.1060307357]))
    assert h_xyz_eclip_j2000("JUPITER",2159345.0)== approx(np.array([-3.3554806095,-4.2166702224,0.0919417675]))
    assert h_xyz_eclip_j2000("JUPITER",2122820.0)== approx(np.array([0.4207861894,5.101959131,-0.0280087663]))
    assert h_xyz_eclip_j2000("SATURN",2451545.0)== approx(np.array([6.4064068573,6.5699929449,-0.3690768029]))
    assert h_xyz_eclip_j2000("SATURN",2415020.0)== approx(np.array([-0.369597375,-10.0582398188,0.1916854382]))
    assert h_xyz_eclip_j2000("SATURN",2378495.0)== approx(np.array([-5.679091087,7.115247812,0.0978521367]))
    assert h_xyz_eclip_j2000("SATURN",2341970.0)== approx(np.array([8.9934758992,-3.7883225437,-0.2866389234]))
    assert h_xyz_eclip_j2000("SATURN",2305445.0)== approx(np.array([-8.6570276346,-4.4809792498,0.4216252073]))
    assert h_xyz_eclip_j2000("SATURN",2268920.0)== approx(np.array([5.0378574919,7.531062579,-0.3348880611]))
    assert h_xyz_eclip_j2000("SATURN",2232395.0)== approx(np.array([1.2601620699,-10.0267935693,0.1347052714]))
    assert h_xyz_eclip_j2000("SATURN",2195870.0)== approx(np.array([-7.1628125747,5.7482646991,0.1724961738]))
    assert h_xyz_eclip_j2000("SATURN",2159345.0)== approx(np.array([9.3511669242,-2.1145906249,-0.3231241535]))
    assert h_xyz_eclip_j2000("SATURN",2122820.0)== approx(np.array([-7.9395559173,-5.8435867016,0.4165601597]))
    assert h_xyz_eclip_j2000("URANUS",2451545.0)== approx(np.array([14.4318934159,-13.7343162527,-0.2381421963]))
    assert h_xyz_eclip_j2000("URANUS",2415020.0)== approx(np.array([-6.4810833337,-17.8526893406,0.0177935238]))
    assert h_xyz_eclip_j2000("URANUS",2378495.0)== approx(np.array([-18.2708335178,0.9877655715,0.242034428]))
    assert h_xyz_eclip_j2000("URANUS",2341970.0)== approx(np.array([-4.2214391936,18.3160266384,0.1247592568]))
    assert h_xyz_eclip_j2000("URANUS",2305445.0)== approx(np.array([16.1020987626,11.4900726864,-0.1664618891]))
    assert h_xyz_eclip_j2000("URANUS",2268920.0)== approx(np.array([17.7683247787,-9.2421595876,-0.2680482375]))
    assert h_xyz_eclip_j2000("URANUS",2232395.0)== approx(np.array([-0.7868164612,-19.2532559478,-0.063642408]))
    assert h_xyz_eclip_j2000("URANUS",2195870.0)== approx(np.array([-17.6539243375,-5.1636568776,0.2124669126]))
    assert h_xyz_eclip_j2000("URANUS",2159345.0)== approx(np.array([-9.8287104597,15.7711888605,0.1914817351]))
    assert h_xyz_eclip_j2000("URANUS",2122820.0)== approx(np.array([11.8546461039,15.5595370553,-0.0950189343]))
    assert h_xyz_eclip_j2000("NEPTUNE",2451545.0)== approx(np.array([16.8121116576,-24.9916630908,0.1272190171]))
    assert h_xyz_eclip_j2000("NEPTUNE",2415020.0)== approx(np.array([1.5164557467,29.8254538901,-0.6491400216]))
    assert h_xyz_eclip_j2000("NEPTUNE",2378495.0)== approx(np.array([-20.3138943578,-22.4908255796,0.9309151535]))
    assert h_xyz_eclip_j2000("NEPTUNE",2341970.0)== approx(np.array([29.502281195,4.5987701114,-0.7740507255]))
    assert h_xyz_eclip_j2000("NEPTUNE",2305445.0)== approx(np.array([-26.5823264272,14.1935610229,0.3196842255]))
    assert h_xyz_eclip_j2000("NEPTUNE",2268920.0)== approx(np.array([11.1160686193,-28.0548309589,0.3216732257]))
    assert h_xyz_eclip_j2000("NEPTUNE",2232395.0)== approx(np.array([8.0214324006,28.723491608,-0.7759058527]))
    assert h_xyz_eclip_j2000("NEPTUNE",2195870.0)== approx(np.array([-24.6234347578,-17.6514428046,0.9297244003]))
    assert h_xyz_eclip_j2000("NEPTUNE",2159345.0)== approx(np.array([29.8303563036,-2.0338910503,-0.6441246887]))
    assert h_xyz_eclip_j2000("NEPTUNE",2122820.0)== approx(np.array([-22.798517087,19.5994768858,0.1206374034]))
    #assert h_xyz_eclip_j2000("EARTH",2451545.0)== approx(np.array([-0.177159144,0.9672192891,-9.536e-07]))
    #assert h_xyz_eclip_j2000("EARTH-M",2415020.0)== approx(np.array([-0.1883097013,0.9650388428,0.0002152687]))
    #assert h_xyz_eclip_j2000("EARTH-M",2378495.0)== approx(np.array([-0.1993643284,0.9627828195,0.0004282504]))
    #assert h_xyz_eclip_j2000("EARTH-M",2341970.0)== approx(np.array([-0.2104343221,0.9603642782,0.0006462945]))
    #assert h_xyz_eclip_j2000("EARTH-M",2305445.0)== approx(np.array([-0.2214911209,0.9578778167,0.0008589738]))
    #assert h_xyz_eclip_j2000("EARTH-M",2268920.0)== approx(np.array([-0.2324953837,0.9552252051,0.0010711791]))
    #assert h_xyz_eclip_j2000("EARTH-M",2232395.0)== approx(np.array([-0.2435434218,0.9524355203,0.0012855339]))
    #assert h_xyz_eclip_j2000("EARTH-M",2195870.0)== approx(np.array([-0.2544800656,0.9495642257,0.0014936626]))
    #assert h_xyz_eclip_j2000("EARTH-M",2159345.0)== approx(np.array([-0.2654471686,0.9464953236,0.0017047755]))
    #assert h_xyz_eclip_j2000("EARTH-M",2122820.0)== approx(np.array([-0.2762837551,0.9433889919,0.0019144183]))    
    
def test_series_C():
    assert h_xyz_eclip_eqxdate("MERCURY",2451545.0)== approx(np.array([-0.1300934112,-0.4472876717,-0.0245983802]))
    assert h_xyz_eclip_eqxdate("MERCURY",2415020.0)== approx(np.array([-0.3932698769,-0.1406751043,0.0236616333]))
    assert h_xyz_eclip_eqxdate("MERCURY",2378495.0)== approx(np.array([-0.1548281758,0.2814058364,0.0376921749]))
    assert h_xyz_eclip_eqxdate("MERCURY",2341970.0)== approx(np.array([0.3312331229,0.0640513914,-0.0230592735]))
    assert h_xyz_eclip_eqxdate("MERCURY",2305445.0)== approx(np.array([0.1950803107,-0.3828531309,-0.0505441569]))
    assert h_xyz_eclip_eqxdate("MERCURY",2268920.0)== approx(np.array([-0.2020188182,-0.4195626841,-0.0212980091]))
    assert h_xyz_eclip_eqxdate("MERCURY",2232395.0)== approx(np.array([-0.4084179067,-0.0700940263,0.0265456213]))
    assert h_xyz_eclip_eqxdate("MERCURY",2195870.0)== approx(np.array([-0.0951835365,0.3043652763,0.0360858544]))
    assert h_xyz_eclip_eqxdate("MERCURY",2159345.0)== approx(np.array([0.3404269126,-0.0004094321,-0.0262202012]))
    assert h_xyz_eclip_eqxdate("MERCURY",2122820.0)== approx(np.array([0.127958835,-0.4129965856,-0.0496477652]))
    assert h_xyz_eclip_eqxdate("VENUS",2451545.0)== approx(np.array([-0.718302279,-0.0326545995,0.0410142975]))
    assert h_xyz_eclip_eqxdate("VENUS",2415020.0)== approx(np.array([0.6919778854,-0.2203045663,-0.0429874499]))
    assert h_xyz_eclip_eqxdate("VENUS",2378495.0)== approx(np.array([-0.5783536698,0.4245514325,0.0396658692]))
    assert h_xyz_eclip_eqxdate("VENUS",2341970.0)== approx(np.array([0.4103332105,-0.6008366749,-0.0331993665]))
    assert h_xyz_eclip_eqxdate("VENUS",2305445.0)== approx(np.array([-0.1835053718,0.6944530427,0.0223743314]))
    assert h_xyz_eclip_eqxdate("VENUS",2268920.0)== approx(np.array([-0.045673889,-0.725823814,-0.0105778293]))
    assert h_xyz_eclip_eqxdate("VENUS",2232395.0)== approx(np.array([0.2925184049,0.6584829436,-0.0038981667]))
    assert h_xyz_eclip_eqxdate("VENUS",2195870.0)== approx(np.array([-0.481762208,-0.5412019869,0.0161128116]))
    assert h_xyz_eclip_eqxdate("VENUS",2159345.0)== approx(np.array([0.6411201421,0.3341571871,-0.0286090464]))
    assert h_xyz_eclip_eqxdate("VENUS",2122820.0)== approx(np.array([-0.7099110735,-0.1240161268,0.0364255617]))
    assert h_xyz_eclip_eqxdate("EARTH",2451545.0)== approx(np.array([-0.1771354615,0.9672416229,-3.9e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2415020.0)== approx(np.array([-0.1647294827,0.9693720024,-5.579e-07]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2378495.0)== approx(np.array([-0.1522449491,0.9713689619,2.038e-07]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2341970.0)== approx(np.array([-0.1397668624,0.9731643443,2.4631e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2305445.0)== approx(np.array([-0.1272616591,0.974853887,-1.609e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2268920.0)== approx(np.array([-0.1147252848,0.9763645265,-2.0004e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2232395.0)== approx(np.array([-0.1022656436,0.9777418151,3.7246e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2195870.0)== approx(np.array([-0.0897381298,0.9789899623,1.4875e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2159345.0)== approx(np.array([-0.0773033683,0.9799998884,-1.2777e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("EARTH",2122820.0)== approx(np.array([-0.0647576071,0.9808979021,-3.0761e-06]),abs=1.e-06)
    assert h_xyz_eclip_eqxdate("MARS",2451545.0)== approx(np.array([1.3907159218,-0.013415706,-0.0344677967]))
    assert h_xyz_eclip_eqxdate("MARS",2415020.0)== approx(np.array([0.3952725706,-1.365284204,-0.038665453]))
    assert h_xyz_eclip_eqxdate("MARS",2378495.0)== approx(np.array([-1.1640169843,-1.040846124,0.0054605962]))
    assert h_xyz_eclip_eqxdate("MARS",2341970.0)== approx(np.array([-1.6160583003,0.3697531114,0.0464755338]))
    assert h_xyz_eclip_eqxdate("MARS",2305445.0)== approx(np.array([-0.6896577496,1.4840391395,0.0492235328]))
    assert h_xyz_eclip_eqxdate("MARS",2268920.0)== approx(np.array([0.8106181241,1.2767287234,0.0100837679]))
    assert h_xyz_eclip_eqxdate("MARS",2232395.0)== approx(np.array([1.3682927953,-0.2563584217,-0.0371492613]))
    assert h_xyz_eclip_eqxdate("MARS",2195870.0)== approx(np.array([0.1516988677,-1.412284759,-0.0362328071]))
    assert h_xyz_eclip_eqxdate("MARS",2159345.0)== approx(np.array([-1.3274727561,-0.8181547191,0.0102739788]))
    assert h_xyz_eclip_eqxdate("MARS",2122820.0)== approx(np.array([-1.5224566563,0.6524641789,0.0489639473]))
    assert h_xyz_eclip_eqxdate("JUPITER",2451545.0)== approx(np.array([4.0011739729,2.938581026,-0.1017837501]))
    assert h_xyz_eclip_eqxdate("JUPITER",2415020.0)== approx(np.array([-3.1268885679,-4.3833244169,0.0869356576]))
    assert h_xyz_eclip_eqxdate("JUPITER",2378495.0)== approx(np.array([0.2320147906,5.1265494302,-0.0223783436]))
    assert h_xyz_eclip_eqxdate("JUPITER",2341970.0)== approx(np.array([0.9111045637,-5.1081933867,-0.0057585786]))
    assert h_xyz_eclip_eqxdate("JUPITER",2305445.0)== approx(np.array([-3.6969935264,3.858024575,0.075092748]))
    assert h_xyz_eclip_eqxdate("JUPITER",2268920.0)== approx(np.array([4.3137648979,-2.5299346444,-0.0942014785]))
    assert h_xyz_eclip_eqxdate("JUPITER",2232395.0)== approx(np.array([-5.440154918,0.2866406676,0.1259503903]))
    assert h_xyz_eclip_eqxdate("JUPITER",2195870.0)== approx(np.array([4.6200396688,1.8327269764,-0.1105815012]))
    assert h_xyz_eclip_eqxdate("JUPITER",2159345.0)== approx(np.array([-4.1078797676,-3.4875973204,0.1000010863]))
    assert h_xyz_eclip_eqxdate("JUPITER",2122820.0)== approx(np.array([1.519136897,4.888616189,-0.0385666565]))
    assert h_xyz_eclip_eqxdate("SATURN",2451545.0)== approx(np.array([6.406406782,6.569992847,-0.3690768029]))
    assert h_xyz_eclip_eqxdate("SATURN",2415020.0)== approx(np.array([-0.6146416433,-10.0461993857,0.1939776737]))
    assert h_xyz_eclip_eqxdate("SATURN",2378495.0)== approx(np.array([-5.3256669097,7.3835415374,0.0948256372]))
    assert h_xyz_eclip_eqxdate("SATURN",2341970.0)== approx(np.array([8.692763123,-4.4352082613,-0.2845245099]))
    assert h_xyz_eclip_eqxdate("SATURN",2305445.0)== approx(np.array([-9.0518360159,-3.6171280351,0.4262838732]))
    assert h_xyz_eclip_eqxdate("SATURN",2268920.0)== approx(np.array([5.9153005788,6.862946408,-0.3438712176]))
    assert h_xyz_eclip_eqxdate("SATURN",2232395.0)== approx(np.array([-0.2128973849,-10.1032378666,0.1483307262]))
    assert h_xyz_eclip_eqxdate("SATURN",2195870.0)== approx(np.array([-6.0841827843,6.8799721146,0.1639880235]))
    assert h_xyz_eclip_eqxdate("SATURN",2159345.0)== approx(np.array([8.7651857163,-3.8844835882,-0.3202091755]))
    assert h_xyz_eclip_eqxdate("SATURN",2122820.0)== approx(np.array([-9.0192283867,-3.9782745625,0.4294447827]))
    assert h_xyz_eclip_eqxdate("URANUS",2451545.0)== approx(np.array([14.4318933505,-13.7343158729,-0.2381421963]))
    assert h_xyz_eclip_eqxdate("URANUS",2415020.0)== approx(np.array([-6.9142977663,-17.6894115248,0.0219752002]))
    assert h_xyz_eclip_eqxdate("URANUS",2378495.0)== approx(np.array([-18.2009931564,1.8769054707,0.2422602627]))
    assert h_xyz_eclip_eqxdate("URANUS",2341970.0)== approx(np.array([-2.8725042471,18.5754947897,0.1124718875]))
    assert h_xyz_eclip_eqxdate("URANUS",2305445.0)== approx(np.array([17.1435210736,9.8688935302,-0.1780035971]))
    assert h_xyz_eclip_eqxdate("URANUS",2268920.0)== approx(np.array([16.5140119842,-11.3323922781,-0.2588956123]))
    assert h_xyz_eclip_eqxdate("URANUS",2232395.0)== approx(np.array([-3.5812895193,-18.9336732631,-0.037196346]))
    assert h_xyz_eclip_eqxdate("URANUS",2195870.0)== approx(np.array([-18.2738161643,-2.0946851368,0.2224238136]))
    assert h_xyz_eclip_eqxdate("URANUS",2159345.0)== approx(np.array([-6.5914700062,17.3751653226,0.163623761]))
    assert h_xyz_eclip_eqxdate("URANUS",2122820.0)== approx(np.array([14.951805106,12.6122126488,-0.1283414181]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2451545.0)== approx(np.array([16.8121111222,-24.9916630358,0.1272190171]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2415020.0)== approx(np.array([2.2429528712,29.7794830302,-0.6559452812]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2378495.0)== approx(np.array([-21.3855253884,-21.4739440135,0.94189554]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2341970.0)== approx(np.array([29.7592752326,2.4313629968,-0.778742881]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2305445.0)== approx(np.array([-25.0753375458,16.7126213836,0.3085091531]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2268920.0)== approx(np.array([7.6259089976,-29.1970035319,0.3528023108]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2232395.0)== approx(np.array([12.1172445471,27.2486873864,-0.8159624537]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2195870.0)== approx(np.array([-27.2598513119,-13.218533584,0.960328195]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2159345.0)== approx(np.array([28.8728659385,-7.7682281056,-0.6434491288]))
    assert h_xyz_eclip_eqxdate("NEPTUNE",2122820.0)== approx(np.array([-17.9958638451,24.0846111039,0.0826739833]))

def test_series_D():
    assert h_rlb_eclip_eqxdate("MERCURY",2451545.0)== approx(np.array([0.4664714751,4.4293481036,-0.0527573409]))
    assert h_rlb_eclip_eqxdate("MERCURY",2415020.0)== approx(np.array([0.4183426275,3.4851161911,0.0565906173]))
    assert h_rlb_eclip_eqxdate("MERCURY",2378495.0)== approx(np.array([0.3233909533,2.0737894888,0.1168184804]))
    assert h_rlb_eclip_eqxdate("MERCURY",2341970.0)== approx(np.array([0.3381563139,0.1910149587,-0.0682441256]))
    assert h_rlb_eclip_eqxdate("MERCURY",2305445.0)== approx(np.array([0.4326517759,5.183642182,-0.1170914848]))
    assert h_rlb_eclip_eqxdate("MERCURY",2268920.0)== approx(np.array([0.4661523936,4.2636517903,-0.0457048516]))
    assert h_rlb_eclip_eqxdate("MERCURY",2232395.0)== approx(np.array([0.4152385205,3.3115600862,0.0639722347]))
    assert h_rlb_eclip_eqxdate("MERCURY",2195870.0)== approx(np.array([0.3209366232,1.8738888759,0.1126774697]))
    assert h_rlb_eclip_eqxdate("MERCURY",2159345.0)== approx(np.array([0.341435425,6.281982606,-0.0768697084]))
    assert h_rlb_eclip_eqxdate("MERCURY",2122820.0)== approx(np.array([0.4352063237,5.0128397764,-0.1143275808]))
    assert h_rlb_eclip_eqxdate("VENUS",2451545.0)== approx(np.array([0.7202129253,3.1870221833,0.0569782849]))
    assert h_rlb_eclip_eqxdate("VENUS",2415020.0)== approx(np.array([0.7274719359,5.9749622238,-0.0591260014]))
    assert h_rlb_eclip_eqxdate("VENUS",2378495.0)== approx(np.array([0.7185473298,2.5083656668,0.0552309407]))
    assert h_rlb_eclip_eqxdate("VENUS",2341970.0)== approx(np.array([0.7283407528,5.3115708036,-0.0455979904]))
    assert h_rlb_eclip_eqxdate("VENUS",2305445.0)== approx(np.array([0.7186375037,1.8291359617,0.0311394084]))
    assert h_rlb_eclip_eqxdate("VENUS",2268920.0)== approx(np.array([0.7273363753,4.6495448744,-0.0145437542]))
    assert h_rlb_eclip_eqxdate("VENUS",2232395.0)== approx(np.array([0.7205428514,1.1527504143,-0.0054100666]))
    assert h_rlb_eclip_eqxdate("VENUS",2195870.0)== approx(np.array([0.7247441174,3.9850309909,0.0222342485]))
    assert h_rlb_eclip_eqxdate("VENUS",2159345.0)== approx(np.array([0.7235430458,0.4804699931,-0.039550525]))
    assert h_rlb_eclip_eqxdate("VENUS",2122820.0)== approx(np.array([0.7215819783,3.3145399295,0.0505016053]))
    assert h_rlb_eclip_eqxdate("EARTH",2451545.0)== approx(np.array([0.9833276819,1.7519238681,-3.9656e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2415020.0)== approx(np.array([0.9832689778,1.7391225563,-5.679e-07]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2378495.0)== approx(np.array([0.9832274321,1.7262638916,2.083e-07]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2341970.0)== approx(np.array([0.9831498441,1.7134419105,2.5051e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2305445.0)== approx(np.array([0.9831254376,1.7006065938,-1.6359e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2268920.0)== approx(np.array([0.9830816756,1.687762496,-2.034e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2232395.0)== approx(np.array([0.9830754409,1.6750110961,3.7879e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2195870.0)== approx(np.array([0.9830942385,1.6622048657,1.5133e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2159345.0)== approx(np.array([0.9830440397,1.6495143197,-1.3003e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("EARTH",2122820.0)== approx(np.array([0.9830331815,1.6367193623,-3.1292e-06]),abs=1.e-06)
    assert h_rlb_eclip_eqxdate("MARS",2451545.0)== approx(np.array([1.3912076925,6.2735389983,-0.0247779824]))
    assert h_rlb_eclip_eqxdate("MARS",2415020.0)== approx(np.array([1.4218777705,4.9942005211,-0.0271965869]))
    assert h_rlb_eclip_eqxdate("MARS",2378495.0)== approx(np.array([1.5615140011,3.8711855478,0.0034969939]))
    assert h_rlb_eclip_eqxdate("MARS",2341970.0)== approx(np.array([1.6584697082,2.916664869,0.0280268149]))
    assert h_rlb_eclip_eqxdate("MARS",2305445.0)== approx(np.array([1.6371997207,2.0058210394,0.0300702181]))
    assert h_rlb_eclip_eqxdate("MARS",2268920.0)== approx(np.array([1.512362269,1.0050966939,0.0066676098]))
    assert h_rlb_eclip_eqxdate("MARS",2232395.0)== approx(np.array([1.3925964529,6.0979760762,-0.0266794243]))
    assert h_rlb_eclip_eqxdate("MARS",2195870.0)== approx(np.array([1.4208707215,4.8193924948,-0.0255031923]))
    assert h_rlb_eclip_eqxdate("MARS",2159345.0)== approx(np.array([1.5593802008,3.6939294875,0.0065885509]))
    assert h_rlb_eclip_eqxdate("MARS",2122820.0)== approx(np.array([1.6571002307,2.7367104344,0.0295522719]))
    assert h_rlb_eclip_eqxdate("JUPITER",2451545.0)== approx(np.array([4.9653813154,0.6334614186,-0.0205001039]))
    assert h_rlb_eclip_eqxdate("JUPITER",2415020.0)== approx(np.array([5.3850276671,4.0927527024,0.0161446618]))
    assert h_rlb_eclip_eqxdate("JUPITER",2378495.0)== approx(np.array([5.1318457604,1.5255696771,-0.0043606936]))
    assert h_rlb_eclip_eqxdate("JUPITER",2341970.0)== approx(np.array([5.1888133656,4.8888943125,-0.0011098085]))
    assert h_rlb_eclip_eqxdate("JUPITER",2305445.0)== approx(np.array([5.3439455032,2.3348832684,0.0140523907]))
    assert h_rlb_eclip_eqxdate("JUPITER",2268920.0)== approx(np.array([5.0018007395,5.7527666852,-0.0188346311]))
    assert h_rlb_eclip_eqxdate("JUPITER",2232395.0)== approx(np.array([5.4491570191,3.088951535,0.0231157947]))
    assert h_rlb_eclip_eqxdate("JUPITER",2195870.0)== approx(np.array([4.9715071036,0.377650343,-0.0222448936]))
    assert h_rlb_eclip_eqxdate("JUPITER",2159345.0)== approx(np.array([5.3896206945,3.8455069137,0.0185554473]))
    assert h_rlb_eclip_eqxdate("JUPITER",2122820.0)== approx(np.array([5.1193587362,1.2695066546,-0.007533574]))
    assert h_rlb_eclip_eqxdate("SATURN",2451545.0)== approx(np.array([9.1838483715,0.7980038761,-0.0401984149]))
    assert h_rlb_eclip_eqxdate("SATURN",2415020.0)== approx(np.array([10.0668531997,4.6512836347,0.0192701409]))
    assert h_rlb_eclip_eqxdate("SATURN",2378495.0)== approx(np.array([9.1043068639,2.1956677359,0.0104156566]))
    assert h_rlb_eclip_eqxdate("SATURN",2341970.0)== approx(np.array([9.7629994924,5.8113963637,-0.0291472787]))
    assert h_rlb_eclip_eqxdate("SATURN",2305445.0)== approx(np.array([9.7571035629,3.5217555199,0.0437035058]))
    assert h_rlb_eclip_eqxdate("SATURN",2268920.0)== approx(np.array([9.0669212839,0.8594235308,-0.0379350088]))
    assert h_rlb_eclip_eqxdate("SATURN",2232395.0)== approx(np.array([10.1065692994,4.6913199264,0.0146771898]))
    assert h_rlb_eclip_eqxdate("SATURN",2195870.0)== approx(np.array([9.1857599537,2.2948875823,0.0178533697]))
    assert h_rlb_eclip_eqxdate("SATURN",2159345.0)== approx(np.array([9.592717394,5.8660241564,-0.0333866503]))
    assert h_rlb_eclip_eqxdate("SATURN",2122820.0)== approx(np.array([9.8669939498,3.5570108069,0.0435371139]))
    assert h_rlb_eclip_eqxdate("URANUS",2451545.0)== approx(np.array([19.9240482667,5.5225485803,-0.0119527838]))
    assert h_rlb_eclip_eqxdate("URANUS",2415020.0)== approx(np.array([18.992716362,4.3397761173,0.0011570307]))
    assert h_rlb_eclip_eqxdate("URANUS",2378495.0)== approx(np.array([18.2991154397,3.0388348558,0.0132392955]))
    assert h_rlb_eclip_eqxdate("URANUS",2341970.0)== approx(np.array([18.7966208854,1.724220472,0.0059836565]))
    assert h_rlb_eclip_eqxdate("URANUS",2305445.0)== approx(np.array([19.7819882707,0.5223325214,-0.0089983885]))
    assert h_rlb_eclip_eqxdate("URANUS",2268920.0)== approx(np.array([20.0300462993,5.6817615582,-0.0129257254]))
    assert h_rlb_eclip_eqxdate("URANUS",2232395.0)== approx(np.array([19.2694311058,4.5254482963,-0.001930334]))
    assert h_rlb_eclip_eqxdate("URANUS",2195870.0)== approx(np.array([18.3948228639,3.255722172,0.0120919639]))
    assert h_rlb_eclip_eqxdate("URANUS",2159345.0)== approx(np.array([18.5841501334,1.9333853935,0.0088045918]))
    assert h_rlb_eclip_eqxdate("URANUS",2122820.0)== approx(np.array([19.5612078271,0.7007226224,-0.0065610611]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2451545.0)== approx(np.array([30.1205328392,5.3045629252,0.0042236789]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2415020.0)== approx(np.array([29.8710345051,1.4956195225,-0.021961003]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2378495.0)== approx(np.array([30.3209192288,3.9290537977,0.0310692112]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2341970.0)== approx(np.array([29.8685860491,0.0815199679,-0.0260752533]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2305445.0)== approx(np.array([30.1360158724,2.5537079778,0.010237401]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2268920.0)== approx(np.array([30.1785350169,4.9678695785,0.0116907777]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2232395.0)== approx(np.array([29.8326055236,1.1523661584,-0.0273547725]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2195870.0)== approx(np.array([30.310911496,3.5930943433,0.0316878975]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2159345.0)== approx(np.array([29.9065506848,6.020359658,-0.0215169842]))
    assert h_rlb_eclip_eqxdate("NEPTUNE",2122820.0)== approx(np.array([30.065369361,2.2124988267,0.0027498093]))
    
def test_series_B():
    assert h_rlb_eclip_j2000("MERCURY",2451545.0)== approx(np.array([0.4664714751,4.4293481043,-0.0527573411]))
    assert h_rlb_eclip_j2000("MERCURY",2415020.0)== approx(np.array([0.4183426276,3.5095041512,0.0564907883]))
    assert h_rlb_eclip_j2000("MERCURY",2378495.0)== approx(np.array([0.3233909531,2.1225631484,0.1171864614]))
    assert h_rlb_eclip_j2000("MERCURY",2341970.0)== approx(np.array([0.3381563139,0.2641557554,-0.0680150537]))
    assert h_rlb_eclip_j2000("MERCURY",2305445.0)== approx(np.array([0.4326517759,5.2811474961,-0.1178238226]))
    assert h_rlb_eclip_j2000("MERCURY",2268920.0)== approx(np.array([0.4661523937,4.3854123464,-0.0468100865]))
    assert h_rlb_eclip_j2000("MERCURY",2232395.0)== approx(np.array([0.4152385207,3.4577380614,0.063462633]))
    assert h_rlb_eclip_j2000("MERCURY",2195870.0)== approx(np.array([0.3209366231,2.0443901595,0.114057417]))
    assert h_rlb_eclip_j2000("MERCURY",2159345.0)== approx(np.array([0.3414354247,0.1936433214,-0.0764174092]))
    assert h_rlb_eclip_j2000("MERCURY",2122820.0)== approx(np.array([0.4352063235,5.2319689071,-0.1160635432]))
    assert h_rlb_eclip_j2000("VENUS",2451545.0)== approx(np.array([0.7202129248,3.187022191,0.0569782849]))
    assert h_rlb_eclip_j2000("VENUS",2415020.0)== approx(np.array([0.7274719352,5.9993518124,-0.0591709804]))
    assert h_rlb_eclip_j2000("VENUS",2378495.0)== approx(np.array([0.7185473293,2.5571297503,0.0554510891]))
    assert h_rlb_eclip_j2000("VENUS",2341970.0)== approx(np.array([0.7283407523,5.3846889524,-0.0460995953]))
    assert h_rlb_eclip_j2000("VENUS",2305445.0)== approx(np.array([0.7186375045,1.9265887457,0.0319707652]))
    assert h_rlb_eclip_j2000("VENUS",2268920.0)== approx(np.array([0.7273363751,4.7713211615,-0.0156777292]))
    assert h_rlb_eclip_j2000("VENUS",2232395.0)== approx(np.array([0.7205428515,1.2988483958,-0.0040667685]))
    assert h_rlb_eclip_j2000("VENUS",2195870.0)== approx(np.array([0.7247441174,4.155455928,0.0208254122]))
    assert h_rlb_eclip_j2000("VENUS",2159345.0)== approx(np.array([0.7235430454,0.6752327774,-0.0383268978]))
    assert h_rlb_eclip_j2000("VENUS",2122820.0)== approx(np.array([0.7215819773,3.5336333775,0.0496161272]))
    assert h_rlb_eclip_j2000("EARTH",2451545.0)== approx(np.array([0.9833276823,1.7519238637,-3.9656e-06]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2415020.0)== approx(np.array([0.9832689762,1.7634989198,0.000218691]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2378495.0)== approx(np.array([0.9832274335,1.7750058558,0.0004381095]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2341970.0)== approx(np.array([0.9831498445,1.7865387214,0.0006583865]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2305445.0)== approx(np.array([0.983125437,1.7980474965,0.0008715329]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2268920.0)== approx(np.array([0.9830816762,1.8095367659,0.0010876906]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2232395.0)== approx(np.array([0.9830754398,1.8211080285,0.0013092603]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2195870.0)== approx(np.array([0.9830942391,1.8326137391,0.0015219401]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2159345.0)== approx(np.array([0.9830440401,1.8442244563,0.0017331615]),abs=1.e-06)
    assert h_rlb_eclip_j2000("EARTH",2122820.0)== approx(np.array([0.9830331809,1.8557201152,0.0019445314]),abs=1.e-06)
    assert h_rlb_eclip_j2000("MARS",2451545.0)== approx(np.array([1.3912076937,6.2735389872,-0.0247779824]),abs=1.e-06)
    assert h_rlb_eclip_j2000("MARS",2415020.0)== approx(np.array([1.4218777718,5.0185792656,-0.02740735]))
    assert h_rlb_eclip_j2000("MARS",2378495.0)== approx(np.array([1.5615140022,3.9199284825,0.0031513365]))
    assert h_rlb_eclip_j2000("MARS",2341970.0)== approx(np.array([1.6584697094,2.989780783,0.0280781217]))
    assert h_rlb_eclip_j2000("MARS",2305445.0)== approx(np.array([1.6371997174,2.1032776583,0.0308218939]))
    assert h_rlb_eclip_j2000("MARS",2268920.0)== approx(np.array([1.5123622675,1.1268677424,0.0077311848]))
    assert h_rlb_eclip_j2000("MARS",2232395.0)== approx(np.array([1.3925964455,6.2441093266,-0.026644954]))
    assert h_rlb_eclip_j2000("MARS",2195870.0)== approx(np.array([1.4208707148,4.9898149167,-0.0270155266]))
    assert h_rlb_eclip_j2000("MARS",2159345.0)== approx(np.array([1.5593802043,3.8886466318,0.0052701267]))
    assert h_rlb_eclip_j2000("MARS",2122820.0)== approx(np.array([1.6571002362,2.9557712523,0.0298285524]))
    assert h_rlb_eclip_j2000("JUPITER",2451545.0)== approx(np.array([4.9653812803,0.6334614217,-0.0205001039]))
    assert h_rlb_eclip_j2000("JUPITER",2415020.0)== approx(np.array([5.3850276351,4.1171308454,0.015945665]))
    assert h_rlb_eclip_j2000("JUPITER",2378495.0)== approx(np.array([5.1318457347,1.5743114744,-0.0039059814]))
    assert h_rlb_eclip_j2000("JUPITER",2341970.0)== approx(np.array([5.1888133706,4.9619913552,-0.0017586234]))
    assert h_rlb_eclip_j2000("JUPITER",2305445.0)== approx(np.array([5.343945525,2.4323346134,0.0145957282]))
    assert h_rlb_eclip_j2000("JUPITER",2268920.0)== approx(np.array([5.0018007431,5.8745612668,-0.0192161117]))
    assert h_rlb_eclip_j2000("JUPITER",2232395.0)== approx(np.array([5.4491570418,3.2350793731,0.0229002244]))
    assert h_rlb_eclip_j2000("JUPITER",2195870.0)== approx(np.array([4.9715070844,0.5480874612,-0.0213293086]))
    assert h_rlb_eclip_j2000("JUPITER",2159345.0)== approx(np.array([5.3896207448,4.0402354041,0.0170598705]))
    assert h_rlb_eclip_j2000("JUPITER",2122820.0)== approx(np.array([5.1193587263,1.488507158,-0.00547118]))
    assert h_rlb_eclip_j2000("SATURN",2451545.0)== approx(np.array([9.1838482881,0.7980038867,-0.0401984149]))
    assert h_rlb_eclip_j2000("SATURN",2415020.0)== approx(np.array([10.0668532372,4.6756597986,0.0190423976]))
    assert h_rlb_eclip_j2000("SATURN",2378495.0)== approx(np.array([9.1043067563,2.2444130058,0.0107481008]))
    assert h_rlb_eclip_j2000("SATURN",2341970.0)== approx(np.array([9.7629995093,5.8845121485,-0.0293639468]))
    assert h_rlb_eclip_j2000("SATURN",2305445.0)== approx(np.array([9.7571035121,3.6192301828,0.0432255907]))
    assert h_rlb_eclip_j2000("SATURN",2268920.0)== approx(np.array([9.0669213668,0.9812189105,-0.0369435533]))
    assert h_rlb_eclip_j2000("SATURN",2232395.0)== approx(np.array([10.1065693352,4.8374129245,0.0133288784]))
    assert h_rlb_eclip_j2000("SATURN",2195870.0)== approx(np.array([9.1857599387,2.4653200325,0.0187797598]))
    assert h_rlb_eclip_j2000("SATURN",2159345.0)== approx(np.array([9.5927174218,6.060794416,-0.0336906976]))
    assert h_rlb_eclip_j2000("SATURN",2122820.0)== approx(np.array([9.8669939127,3.776079419,0.0422300831]))
    assert h_rlb_eclip_j2000("URANUS",2451545.0)== approx(np.array([19.9240478952,5.5225485297,-0.0119527878]))
    assert h_rlb_eclip_j2000("URANUS",2415020.0)== approx(np.array([18.9927163179,4.3641525628,0.000936861]))
    assert h_rlb_eclip_j2000("URANUS",2378495.0)== approx(np.array([18.2991151619,3.0875827851,0.0132269524]))
    assert h_rlb_eclip_j2000("URANUS",2341970.0)== approx(np.array([18.7966207283,1.797318585,0.0066373711]))
    assert h_rlb_eclip_j2000("URANUS",2305445.0)== approx(np.array([19.7819885654,0.6197794565,-0.0084149193]))
    assert h_rlb_eclip_j2000("URANUS",2268920.0)== approx(np.array([20.0300461334,5.8035494552,-0.013382706]))
    assert h_rlb_eclip_j2000("URANUS",2232395.0)== approx(np.array([19.2694312936,4.6715450662,-0.0033027749]))
    assert h_rlb_eclip_j2000("URANUS",2195870.0)== approx(np.array([18.3948232424,3.4261485604,0.0115506263]))
    assert h_rlb_eclip_j2000("URANUS",2159345.0)== approx(np.array([18.5841497556,2.128105005,0.0103036775]))
    assert h_rlb_eclip_j2000("URANUS",2122820.0)== approx(np.array([19.5612080219,0.9197293285,-0.0048575382]))
    assert h_rlb_eclip_j2000("NEPTUNE",2451545.0)== approx(np.array([30.1205329332,5.3045629284,0.004223679]))
    assert h_rlb_eclip_j2000("NEPTUNE",2415020.0)== approx(np.array([29.8710344515,1.5199957208,-0.0217331273]))
    assert h_rlb_eclip_j2000("NEPTUNE",2378495.0)== approx(np.array([30.3209191027,3.9778043127,0.0307068993]))
    assert h_rlb_eclip_j2000("NEPTUNE",2341970.0)== approx(np.array([29.8685861463,0.1546340455,-0.0259181077]))
    assert h_rlb_eclip_j2000("NEPTUNE",2305445.0)== approx(np.array([30.136015886,2.65115747,0.0106082425]))
    assert h_rlb_eclip_j2000("NEPTUNE",2268920.0)== approx(np.array([30.1785349992,5.0896381605,0.0106592138]))
    assert h_rlb_eclip_j2000("NEPTUNE",2232395.0)== approx(np.array([29.8326055361,1.2984703832,-0.0260115821]))
    assert h_rlb_eclip_j2000("NEPTUNE",2195870.0)== approx(np.array([30.3109115122,3.7635416328,0.030677743]))
    assert h_rlb_eclip_j2000("NEPTUNE",2159345.0)== approx(np.array([29.9065506899,6.2151087391,-0.0215395777]))
    assert h_rlb_eclip_j2000("NEPTUNE",2122820.0)== approx(np.array([30.0653694889,2.4315044302,0.0040125142])) 